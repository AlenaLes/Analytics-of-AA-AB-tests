# Анализ результатов АА и АВ тестирования

## Краткое описание

Анализируем данные по приложению, объединяющего ленту новостей и ленту сообщений. Для этого используем результаты АА и АВ тестов, которые были проведены ранее.

Стэк:

- JupiterHub
- Clickhouse
- Python
- Статистические тесты

## АА - тест
Убедимся, что система сплитования работает корректно и ключевая метрика не отличается между группами в АА-тесте.

Данные выгрузили с Clickhouse, всего у нас 42 585 пользователй для АА-теста. Также поставили ограничение по времени выгрузки: с 26.09.2022 по 2.10.2022 и выбрали только 2-ую (экспериментальную) и 3-ью (экспериментальную) группы.

Для проведения теста подсчитали CTR для каждого пользователя и построили график с распределением для информации. На графике видим, что распределение экспериментальных групп практически соврадает.

![image](https://user-images.githubusercontent.com/100629361/206895677-7b6cfc46-f868-4afd-af04-186b8a86284f.png)

Теперь для проверки различий проведем бутстрап.

![image](https://user-images.githubusercontent.com/100629361/206895802-8659d53a-e5dc-4c97-a06c-4009c00cf857.png)

![image](https://user-images.githubusercontent.com/100629361/206895815-091dd806-6d8f-4227-9f0f-3b747f0e9211.png)

Статистически значимые различия получаем в 4,6% , что соответствует ошибке I рода. 
Система сплитования на группы работает корректно.

## АВ - тест

Также, как и в АА-тесте выгрузили данные с Ckickhouse. Ограничение по времени выгрузки: с 3.10.2022 по 9.10.2022 и выбрали только 1-ую (контрольную) и 2-ую (экспериментальную) группы.

Различия распределений по CTR очень хорошо прослеживается. T-test не даст нам гарантированного результата, поэтому будет использовать разные тесты для оценки.

![image](https://user-images.githubusercontent.com/100629361/206896119-ba713976-9dab-4059-805d-6feab1a84784.png)

## T-test

P-value  больше 0,05, поэтому статистически значимого различия нет. Это зависит от того, что распределение ctr второй группы не нормальное, применение теста не корректно
![image](https://user-images.githubusercontent.com/100629361/206896204-ea2e2d3b-8ed6-4000-92b3-f417674f8422.png)


## Mann-Witney test

Тест Манна Уитни показывает статистические различия.

![image](https://user-images.githubusercontent.com/100629361/206896251-df070a32-8944-4cd7-9ace-0ed3fda36434.png)

## Сглаженный CTR

Применим сглаживание для повтрного проведения тестов.
![image](https://user-images.githubusercontent.com/100629361/206896354-2a4b42f6-1951-4e60-bdee-bafd72fa5060.png)

## Повторно проводим тесты на сглаженный CTR

Сглаженный ctr T-test, в отличие от обычного ctr, показывает статистически значимое различие. Тест Манна-Уитни сходится с предыдущим.

![image](https://user-images.githubusercontent.com/100629361/206896427-e05650d1-8baf-44f8-9d0e-02847dba37c4.png)

## Poisson bootstrap

Распределение разницы глобального ctr показывает, что ctr в тестовой группе стал меньше для каждой бустрап-подвыборки
![image](https://user-images.githubusercontent.com/100629361/206896519-cd46c076-2514-4e2a-a993-882bf01abfc6.png)

## Mann-Witney test

Для проведения теста Манна-Уитни сначала провели бакетное преобразование. Аидим, что в среднем глобальный CTR уменьшился.

![image](https://user-images.githubusercontent.com/100629361/206896802-38fb13de-26a3-47e6-916b-d1f2bd5fda41.png)

По результатм теста не рекомендуется раскатывать новый алгоритм на всех пользователей.
